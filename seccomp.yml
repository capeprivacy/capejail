# This is an example seccomp policy for x86_64 that prevents network syscalls.

seccomp:
  # The default action is applied if none of the syscalls match.
  #
  # Possible actions:
  # - kill_process (since Linux 4.14)
  # - kill_thread
  # - trap
  # - errno (returns EPERM)
  # - trace
  # - log (since Linux 4.14)
  # - allow
  default_action: kill_process

  syscalls:
  # Network sandbox example.
  - action: errno
    names:
    - access
    - alarm
    - arch_prctl
    - bind
    - brk
    - capget
    - chmod
    - chown
    - chdir
    - clock_getres
    - clock_gettime
    - clock_nanosleep
    - clone
    - clone3
    - close
    - close_range
    - connect
    - copy_file_range
    - creat
    - dup
    - dup2
    - dup3
    - epoll_create
    - epoll_create1
    - epoll_ctl
    - epoll_ctl_old
    - epoll_pwait
    - epoll_wait
    - epoll_wait_old
    - eventfd
    - eventfd2
    - execve
    - execveat
    - exit
    # - exit_group // Causes jail to crash
    - faccessat
    - faccessat2
    - fadvise64
    - fallocate
    - fanotify_init
    - fanotify_mark
    - fchdir
    - fcntl
    - fdatasync
    - fgetxattr
    - flistxattr
    - flock
    - fork
    - fremovexattr
    - fsetxattr
    - fstat
    - fstatfs
    - fsync
    - ftruncate
    - futex
    - getcpu
    - getcwd
    - getdents
    - getdents64
    - geteuid
    - getegid
    - getgid
    - getgroups
    - getitimer
    - get_mempolicy
    - getpeername
    - getpgid
    - getpgrp
    - getpid
    - getppid
    - getpriority
    - getrandom
    - getresuid
    - getresuid
    - getrlimit
    - get_robust_list
    - getrusage
    - getsid
    - getsockname
    - getsockopt
    - get_thread_area
    - gettid
    - gettimeofday
    - getuid
    - getxattr
    - inotify_add_watch
    - inotify_init
    - inotify_init1
    - inotify_rm_watch
    - io_cancel
    - ioctl
    - io_destroy
    - io_getevents
    - ioprio_get
    - ioprio_set
    - io_setup
    - io_setup
    - io_submit
    - io_uring_enter
    - io_uring_register
    - io_uring_setup
    - kill
    - lchown
    - lgetxattr
    - listxattr
    - llistxattr
    - lookup_dcookie
    - lremovexattr
    - lseek
    - lsetxattr
    - lstat
    - madvise
    - mbind
    - membarrier
    - memfd_create
    - memfd_secret
    - mincore
    - mkdir
    - mkdirat
    - mlock
    - mlock2
    - mlockall
    - mmap
    - modify_ldt
    - mprotect
    - mq_getsetattr
    - mq_notify
    - mq_open
    - mq_timedreceive
    - mq_timedsend
    - mq_unlink
    - mremap
    - msgctl
    - msgget
    - msgrcv
    - msgsnd
    - msync
    - munlock
    - munlockall
    - munmap
    - name_to_handle_at
    - nanosleep
    - newfstatat
    - open
    - openat
    - openat2
    - open_by_handle_at
    - pause
    - personality
    - pidfd_open
    - pidfd_send_signal
    - pipe
    - pipe2
    - pkey_alloc
    - pkey_free
    - pkey_mprotect
    - poll
    - ppoll
    - prctl
    - pread64
    - preadv
    - prlimit64
    - process_madvise
    - pselect6
    - pwrite64
    - pwritev
    - pwritev2
    - read
    - readahead
    - readlink
    - readlinkat
    - readv
    - recvfrom
    - recvmmsg
    - recvmsg
    - remap_file_pages
    - removexattr
    - rename
    - renameat
    - renameat2
    - restart_syscall
    - rmdir
    - rseq
    - rt_sigaction
    - rt_sigpending
    - rt_sigprocmask
    - rt_sigqueueinfo
    - rt_sigreturn
    - rt_sigsuspend
    - rt_sigtimedwait
    - rt_tgsigqueueinfo
    - sched_getaffinity
    - sched_getattr
    - sched_getparam
    - sched_get_priority_max
    - sched_get_priority_min
    - sched_getscheduler
    - sched_rr_get_interval
    - sched_yield
    - sched_setaffinity
    - select
    - semctl
    - semget
    - semop
    - semtimedop
    - sendfile
    - sendmmsg
    - sendmsg
    - sendto
    - setitimer
    - set_mempolicy
    - setpgid
    - set_robust_list
    - setsid
    - set_thread_area
    - set_tid_address
    - setxattr
    - shmat
    - shmctl
    - shmdt
    - shmget
    - sigaltstack
    - signalfd
    - signalfd4
    - socket
    - socketpair
    - splice
    - stat
    - statfs
    - statx
    - sysfs
    - sysinfo
    - tee
    - tgkill
    - time
    - timer_create
    - timer_delete
    - timerfd_create
    - timerfd_gettime
    - timerfd_settime
    - timer_getoverrun
    - timer_gettime
    - timer_settime
    - times
    - tkill
    - truncate
    - umask
    - uname
    - unlink
    - unlinkat
    - unshare
    - uselib
    - userfaultfd
    - ustat
    - utime
    - utimensat
    - utimes
    - vfork
    - vhangup
    - vmsplice
    - wait4
    - waitid
    - write
    - writev
